{
  "info": {
    "_postman_id": "contractos-api-v1",
    "name": "ContractOS API — Full Integration Suite",
    "description": "Complete API collection for ContractOS contract intelligence platform.\n\nIncludes:\n- Health & Config checks\n- Contract upload, retrieval, facts, clauses, bindings, gaps, graph\n- Q&A with provenance\n- Workspace CRUD, document association, session history, change detection\n- LegalBench / CUAD benchmark document workflows\n\n## How to Run\n\n1. Start the server: `python -m uvicorn contractos.api.app:create_app --host 127.0.0.1 --port 8742 --factory`\n2. Import this collection + environment into Postman\n3. Run the \"Full Integration Workflow\" folder in order\n\nOr use Newman CLI:\n```bash\nnewman run postman/ContractOS.postman_collection.json \\\n  -e postman/ContractOS.postman_environment.json \\\n  --reporters cli,json --reporter-json-export postman/results.json\n```",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    { "key": "base_url", "value": "http://127.0.0.1:8742" }
  ],
  "item": [
    {
      "name": "0 — Health & Config",
      "item": [
        {
          "name": "Health Check",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('Service is ok', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.status).to.eql('ok');",
                  "  pm.expect(body.service).to.eql('contractos');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": { "raw": "{{base_url}}/health", "host": ["{{base_url}}"], "path": ["health"] }
          }
        },
        {
          "name": "Get Config",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('Config has required fields', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body).to.have.property('llm_provider');",
                  "  pm.expect(body).to.have.property('llm_model');",
                  "  pm.expect(body).to.have.property('storage_backend');",
                  "  pm.expect(body).to.have.property('extraction_pipeline');",
                  "  pm.expect(body.extraction_pipeline).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": { "raw": "{{base_url}}/config", "host": ["{{base_url}}"], "path": ["config"] }
          }
        }
      ]
    },
    {
      "name": "1 — Contract Upload & Indexing",
      "item": [
        {
          "name": "Upload DOCX (Simple Procurement)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 201 Created', () => pm.response.to.have.status(201));",
                  "pm.test('Contract indexed successfully', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.document_id).to.match(/^doc-/);",
                  "  pm.expect(body.file_format).to.eql('docx');",
                  "  pm.expect(body.status).to.eql('indexed');",
                  "  pm.expect(body.fact_count).to.be.above(0);",
                  "  pm.expect(body.clause_count).to.be.above(0);",
                  "  pm.expect(body.word_count).to.be.above(0);",
                  "  // Save document_id for downstream requests",
                  "  pm.environment.set('document_id', body.document_id);",
                  "  pm.environment.set('docx_document_id', body.document_id);",
                  "  console.log('Indexed DOCX:', body.document_id, '| Facts:', body.fact_count, '| Clauses:', body.clause_count);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "file",
                  "type": "file",
                  "src": "{{docx_fixture}}"
                }
              ]
            },
            "url": { "raw": "{{base_url}}/contracts/upload", "host": ["{{base_url}}"], "path": ["contracts", "upload"] }
          }
        },
        {
          "name": "Upload PDF (Simple NDA)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 201 Created', () => pm.response.to.have.status(201));",
                  "pm.test('PDF indexed', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.file_format).to.eql('pdf');",
                  "  pm.expect(body.status).to.eql('indexed');",
                  "  pm.environment.set('pdf_document_id', body.document_id);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "file",
                  "type": "file",
                  "src": "{{pdf_fixture}}"
                }
              ]
            },
            "url": { "raw": "{{base_url}}/contracts/upload", "host": ["{{base_url}}"], "path": ["contracts", "upload"] }
          }
        },
        {
          "name": "Upload Complex DOCX (IT Outsourcing $47.5M)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 201 Created', () => pm.response.to.have.status(201));",
                  "pm.test('Complex DOCX indexed with rich extraction', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.status).to.eql('indexed');",
                  "  pm.expect(body.fact_count).to.be.above(50);",
                  "  pm.expect(body.clause_count).to.be.above(5);",
                  "  pm.environment.set('complex_docx_id', body.document_id);",
                  "  console.log('Complex DOCX:', body.fact_count, 'facts,', body.clause_count, 'clauses,', body.binding_count, 'bindings');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                { "key": "file", "type": "file", "src": "{{complex_docx_fixture}}" }
              ]
            },
            "url": { "raw": "{{base_url}}/contracts/upload", "host": ["{{base_url}}"], "path": ["contracts", "upload"] }
          }
        },
        {
          "name": "Upload Complex PDF (Procurement Framework £85M)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 201 Created', () => pm.response.to.have.status(201));",
                  "pm.test('Complex PDF indexed', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.status).to.eql('indexed');",
                  "  pm.environment.set('complex_pdf_id', body.document_id);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                { "key": "file", "type": "file", "src": "{{complex_pdf_fixture}}" }
              ]
            },
            "url": { "raw": "{{base_url}}/contracts/upload", "host": ["{{base_url}}"], "path": ["contracts", "upload"] }
          }
        },
        {
          "name": "Upload LegalBench NDA",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 201 Created', () => pm.response.to.have.status(201));",
                  "pm.test('LegalBench NDA indexed', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.status).to.eql('indexed');",
                  "  pm.environment.set('legalbench_nda_id', body.document_id);",
                  "  console.log('LegalBench NDA:', body.fact_count, 'facts,', body.clause_count, 'clauses');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                { "key": "file", "type": "file", "src": "{{legalbench_nda_fixture}}" }
              ]
            },
            "url": { "raw": "{{base_url}}/contracts/upload", "host": ["{{base_url}}"], "path": ["contracts", "upload"] }
          }
        },
        {
          "name": "Upload CUAD License Agreement",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 201 Created', () => pm.response.to.have.status(201));",
                  "pm.test('CUAD License Agreement indexed', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.status).to.eql('indexed');",
                  "  pm.environment.set('cuad_license_id', body.document_id);",
                  "  console.log('CUAD License:', body.fact_count, 'facts,', body.clause_count, 'clauses');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                { "key": "file", "type": "file", "src": "{{cuad_license_fixture}}" }
              ]
            },
            "url": { "raw": "{{base_url}}/contracts/upload", "host": ["{{base_url}}"], "path": ["contracts", "upload"] }
          }
        },
        {
          "name": "Upload Unsupported Format → 400",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 400 for unsupported format', () => pm.response.to.have.status(400));",
                  "pm.test('Error message mentions format', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.detail).to.include('Unsupported format');",
                  "});"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "// This test sends a .txt file to verify rejection"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "file",
                  "type": "file",
                  "src": "README.md",
                  "description": "Intentionally wrong format"
                }
              ]
            },
            "url": { "raw": "{{base_url}}/contracts/upload", "host": ["{{base_url}}"], "path": ["contracts", "upload"] }
          }
        }
      ]
    },
    {
      "name": "2 — Contract Retrieval & Exploration",
      "item": [
        {
          "name": "Get Contract Metadata",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('Contract metadata is complete', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.document_id).to.eql(pm.environment.get('document_id'));",
                  "  pm.expect(body).to.have.property('title');",
                  "  pm.expect(body).to.have.property('file_format');",
                  "  pm.expect(body).to.have.property('parties');",
                  "  pm.expect(body).to.have.property('fact_count');",
                  "  pm.expect(body).to.have.property('clause_count');",
                  "  pm.expect(body).to.have.property('binding_count');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": { "raw": "{{base_url}}/contracts/{{document_id}}", "host": ["{{base_url}}"], "path": ["contracts", "{{document_id}}"] }
          }
        },
        {
          "name": "Get Contract → 404",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 404 for nonexistent doc', () => pm.response.to.have.status(404));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": { "raw": "{{base_url}}/contracts/doc-nonexistent", "host": ["{{base_url}}"], "path": ["contracts", "doc-nonexistent"] }
          }
        },
        {
          "name": "Get Facts (all)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('Facts returned as array', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body).to.be.an('array');",
                  "  pm.expect(body.length).to.be.above(0);",
                  "  // Validate fact structure",
                  "  const f = body[0];",
                  "  pm.expect(f).to.have.property('fact_id');",
                  "  pm.expect(f).to.have.property('fact_type');",
                  "  pm.expect(f).to.have.property('value');",
                  "  pm.expect(f).to.have.property('text_span');",
                  "  pm.expect(f).to.have.property('char_start');",
                  "  pm.expect(f).to.have.property('char_end');",
                  "  pm.expect(f).to.have.property('location_hint');",
                  "  console.log('Total facts:', body.length);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": { "raw": "{{base_url}}/contracts/{{document_id}}/facts", "host": ["{{base_url}}"], "path": ["contracts", "{{document_id}}", "facts"] }
          }
        },
        {
          "name": "Get Facts (filtered by type: entity)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('All returned facts are entity type', () => {",
                  "  const body = pm.response.json();",
                  "  body.forEach(f => pm.expect(f.fact_type).to.eql('entity'));",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/contracts/{{document_id}}/facts?fact_type=entity",
              "host": ["{{base_url}}"],
              "path": ["contracts", "{{document_id}}", "facts"],
              "query": [{ "key": "fact_type", "value": "entity" }]
            }
          }
        },
        {
          "name": "Get Facts (paginated: limit=5, offset=0)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('Pagination returns at most 5 facts', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.length).to.be.at.most(5);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/contracts/{{document_id}}/facts?limit=5&offset=0",
              "host": ["{{base_url}}"],
              "path": ["contracts", "{{document_id}}", "facts"],
              "query": [
                { "key": "limit", "value": "5" },
                { "key": "offset", "value": "0" }
              ]
            }
          }
        },
        {
          "name": "Get Clauses",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('Clauses returned with types', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body).to.be.an('array');",
                  "  pm.expect(body.length).to.be.above(0);",
                  "  const c = body[0];",
                  "  pm.expect(c).to.have.property('clause_id');",
                  "  pm.expect(c).to.have.property('clause_type');",
                  "  pm.expect(c).to.have.property('heading');",
                  "  console.log('Clause types:', [...new Set(body.map(c => c.clause_type))].join(', '));",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": { "raw": "{{base_url}}/contracts/{{document_id}}/clauses", "host": ["{{base_url}}"], "path": ["contracts", "{{document_id}}", "clauses"] }
          }
        },
        {
          "name": "Get Clauses (filtered: termination)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('Only termination clauses returned', () => {",
                  "  const body = pm.response.json();",
                  "  body.forEach(c => pm.expect(c.clause_type).to.eql('termination'));",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/contracts/{{document_id}}/clauses?clause_type=termination",
              "host": ["{{base_url}}"],
              "path": ["contracts", "{{document_id}}", "clauses"],
              "query": [{ "key": "clause_type", "value": "termination" }]
            }
          }
        },
        {
          "name": "Get Bindings",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('Bindings have required fields', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body).to.be.an('array');",
                  "  if (body.length > 0) {",
                  "    const b = body[0];",
                  "    pm.expect(b).to.have.property('binding_id');",
                  "    pm.expect(b).to.have.property('binding_type');",
                  "    pm.expect(b).to.have.property('term');",
                  "    pm.expect(b).to.have.property('resolves_to');",
                  "  }",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": { "raw": "{{base_url}}/contracts/{{document_id}}/bindings", "host": ["{{base_url}}"], "path": ["contracts", "{{document_id}}", "bindings"] }
          }
        },
        {
          "name": "Get Clause Gaps (Missing Mandatory Facts)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('Gaps response is array', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body).to.be.an('array');",
                  "  if (body.length > 0) {",
                  "    const g = body[0];",
                  "    pm.expect(g).to.have.property('clause_id');",
                  "    pm.expect(g).to.have.property('clause_type');",
                  "    pm.expect(g).to.have.property('fact_spec_name');",
                  "    pm.expect(g).to.have.property('required');",
                  "    pm.expect(g).to.have.property('status');",
                  "  }",
                  "  console.log('Missing mandatory facts:', body.length);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": { "raw": "{{base_url}}/contracts/{{document_id}}/clauses/gaps", "host": ["{{base_url}}"], "path": ["contracts", "{{document_id}}", "clauses", "gaps"] }
          }
        },
        {
          "name": "Get TrustGraph Visualization",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('Graph has nodes and edges', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body).to.have.property('document_id');",
                  "  pm.expect(body).to.have.property('title');",
                  "  pm.expect(body).to.have.property('summary');",
                  "  pm.expect(body).to.have.property('nodes');",
                  "  pm.expect(body).to.have.property('edges');",
                  "  pm.expect(body.nodes).to.be.an('array');",
                  "  pm.expect(body.edges).to.be.an('array');",
                  "  pm.expect(body.nodes.length).to.be.above(0);",
                  "  pm.expect(body.edges.length).to.be.above(0);",
                  "  // Verify node types",
                  "  const nodeTypes = [...new Set(body.nodes.map(n => n.type))];",
                  "  pm.expect(nodeTypes).to.include('contract');",
                  "  pm.expect(nodeTypes).to.include('fact');",
                  "  console.log('Graph:', body.nodes.length, 'nodes,', body.edges.length, 'edges');",
                  "  console.log('Summary:', JSON.stringify(body.summary));",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": { "raw": "{{base_url}}/contracts/{{document_id}}/graph", "host": ["{{base_url}}"], "path": ["contracts", "{{document_id}}", "graph"] }
          }
        }
      ]
    },
    {
      "name": "3 — Q&A with Provenance",
      "item": [
        {
          "name": "Ask: Who are the parties?",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('Answer has provenance', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body).to.have.property('answer');",
                  "  pm.expect(body.answer.length).to.be.above(0);",
                  "  pm.expect(body).to.have.property('confidence');",
                  "  if (body.confidence) {",
                  "    pm.expect(body.confidence).to.have.property('label');",
                  "    pm.expect(body.confidence).to.have.property('score');",
                  "  }",
                  "  if (body.provenance) {",
                  "    pm.expect(body.provenance).to.have.property('nodes');",
                  "    pm.expect(body.provenance).to.have.property('reasoning_summary');",
                  "  }",
                  "  console.log('Answer:', body.answer.substring(0, 200));",
                  "  console.log('Confidence:', body.confidence ? body.confidence.label : 'N/A');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"Who are the parties to this contract?\",\n  \"document_id\": \"{{document_id}}\"\n}"
            },
            "url": { "raw": "{{base_url}}/query/ask", "host": ["{{base_url}}"], "path": ["query", "ask"] }
          }
        },
        {
          "name": "Ask: What is the contract value?",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('Answer returned', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.answer.length).to.be.above(0);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"What is the total contract value or price?\",\n  \"document_id\": \"{{document_id}}\"\n}"
            },
            "url": { "raw": "{{base_url}}/query/ask", "host": ["{{base_url}}"], "path": ["query", "ask"] }
          }
        },
        {
          "name": "Ask: Termination conditions?",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('Answer discusses termination', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.answer.length).to.be.above(0);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"What are the termination conditions and notice period?\",\n  \"document_id\": \"{{document_id}}\"\n}"
            },
            "url": { "raw": "{{base_url}}/query/ask", "host": ["{{base_url}}"], "path": ["query", "ask"] }
          }
        },
        {
          "name": "Ask: Governing law?",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"What is the governing law and jurisdiction?\",\n  \"document_id\": \"{{document_id}}\"\n}"
            },
            "url": { "raw": "{{base_url}}/query/ask", "host": ["{{base_url}}"], "path": ["query", "ask"] }
          }
        },
        {
          "name": "Ask: Nonexistent doc → 404",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 404', () => pm.response.to.have.status(404));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"Who are the parties?\",\n  \"document_id\": \"doc-nonexistent\"\n}"
            },
            "url": { "raw": "{{base_url}}/query/ask", "host": ["{{base_url}}"], "path": ["query", "ask"] }
          }
        }
      ]
    },
    {
      "name": "4 — Workspace Management",
      "item": [
        {
          "name": "Create Workspace",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 201 Created', () => pm.response.to.have.status(201));",
                  "pm.test('Workspace created', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.workspace_id).to.match(/^w-/);",
                  "  pm.expect(body.name).to.eql('Procurement Review');",
                  "  pm.expect(body.indexed_documents).to.be.an('array').that.is.empty;",
                  "  pm.environment.set('workspace_id', body.workspace_id);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Procurement Review\",\n  \"settings\": {\n    \"default_llm\": \"claude-sonnet\",\n    \"confidence_threshold\": 0.7\n  }\n}"
            },
            "url": { "raw": "{{base_url}}/workspaces", "host": ["{{base_url}}"], "path": ["workspaces"] }
          }
        },
        {
          "name": "List Workspaces",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('At least one workspace', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body).to.be.an('array');",
                  "  pm.expect(body.length).to.be.above(0);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": { "raw": "{{base_url}}/workspaces", "host": ["{{base_url}}"], "path": ["workspaces"] }
          }
        },
        {
          "name": "Get Workspace",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('Workspace details correct', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.workspace_id).to.eql(pm.environment.get('workspace_id'));",
                  "  pm.expect(body.name).to.eql('Procurement Review');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": { "raw": "{{base_url}}/workspaces/{{workspace_id}}", "host": ["{{base_url}}"], "path": ["workspaces", "{{workspace_id}}"] }
          }
        },
        {
          "name": "Add Document to Workspace",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 204 No Content', () => pm.response.to.have.status(204));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"document_id\": \"{{document_id}}\"\n}"
            },
            "url": { "raw": "{{base_url}}/workspaces/{{workspace_id}}/documents", "host": ["{{base_url}}"], "path": ["workspaces", "{{workspace_id}}", "documents"] }
          }
        },
        {
          "name": "Verify Document in Workspace",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('Document is associated', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.indexed_documents).to.include(pm.environment.get('document_id'));",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": { "raw": "{{base_url}}/workspaces/{{workspace_id}}", "host": ["{{base_url}}"], "path": ["workspaces", "{{workspace_id}}"] }
          }
        },
        {
          "name": "Remove Document from Workspace",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 204 No Content', () => pm.response.to.have.status(204));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [],
            "url": { "raw": "{{base_url}}/workspaces/{{workspace_id}}/documents/{{document_id}}", "host": ["{{base_url}}"], "path": ["workspaces", "{{workspace_id}}", "documents", "{{document_id}}"] }
          }
        },
        {
          "name": "Re-add Document (for session tests)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 204', () => pm.response.to.have.status(204));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"document_id\": \"{{document_id}}\"\n}"
            },
            "url": { "raw": "{{base_url}}/workspaces/{{workspace_id}}/documents", "host": ["{{base_url}}"], "path": ["workspaces", "{{workspace_id}}", "documents"] }
          }
        },
        {
          "name": "Get Session History",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('Sessions is array', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": { "raw": "{{base_url}}/workspaces/{{workspace_id}}/sessions", "host": ["{{base_url}}"], "path": ["workspaces", "{{workspace_id}}", "sessions"] }
          }
        },
        {
          "name": "Get Workspace → 404",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 404', () => pm.response.to.have.status(404));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": { "raw": "{{base_url}}/workspaces/w-nonexistent", "host": ["{{base_url}}"], "path": ["workspaces", "w-nonexistent"] }
          }
        }
      ]
    },
    {
      "name": "5 — LegalBench Benchmark Queries",
      "description": "Queries modeled after LegalBench benchmark categories:\n- contract_nli (Natural Language Inference)\n- cuad (Contract Understanding Atticus Dataset)\n- consumer_contracts_qa\n- definition_classification\n\nThese test ContractOS's ability to handle real legal reasoning tasks.",
      "item": [
        {
          "name": "[CUAD] Termination for Convenience",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('Answer addresses termination', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.answer.length).to.be.above(10);",
                  "  console.log('[CUAD termination_for_convenience]', body.answer.substring(0, 200));",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"Can either party terminate this agreement for convenience without cause? If so, what is the required notice period?\",\n  \"document_id\": \"{{document_id}}\"\n}"
            },
            "url": { "raw": "{{base_url}}/query/ask", "host": ["{{base_url}}"], "path": ["query", "ask"] }
          }
        },
        {
          "name": "[CUAD] Cap on Liability",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('Answer addresses liability', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.answer.length).to.be.above(10);",
                  "  console.log('[CUAD cap_on_liability]', body.answer.substring(0, 200));",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"Is there a cap on liability? What is the maximum liability amount or formula?\",\n  \"document_id\": \"{{document_id}}\"\n}"
            },
            "url": { "raw": "{{base_url}}/query/ask", "host": ["{{base_url}}"], "path": ["query", "ask"] }
          }
        },
        {
          "name": "[CUAD] Governing Law",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "console.log('[CUAD governing_law]', pm.response.json().answer.substring(0, 200));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"What is the governing law of this agreement? Which jurisdiction applies?\",\n  \"document_id\": \"{{document_id}}\"\n}"
            },
            "url": { "raw": "{{base_url}}/query/ask", "host": ["{{base_url}}"], "path": ["query", "ask"] }
          }
        },
        {
          "name": "[CUAD] Insurance Requirements",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "console.log('[CUAD insurance]', pm.response.json().answer.substring(0, 200));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"Are there any insurance requirements in this contract? What types and minimum amounts?\",\n  \"document_id\": \"{{document_id}}\"\n}"
            },
            "url": { "raw": "{{base_url}}/query/ask", "host": ["{{base_url}}"], "path": ["query", "ask"] }
          }
        },
        {
          "name": "[Contract NLI] Confidentiality Scope",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "console.log('[NLI confidentiality]', pm.response.json().answer.substring(0, 200));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"Does this contract contain confidentiality obligations? What information is considered confidential and what are the exceptions?\",\n  \"document_id\": \"{{document_id}}\"\n}"
            },
            "url": { "raw": "{{base_url}}/query/ask", "host": ["{{base_url}}"], "path": ["query", "ask"] }
          }
        },
        {
          "name": "[Contract NLI] Survival of Obligations",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "console.log('[NLI survival]', pm.response.json().answer.substring(0, 200));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"Which obligations survive termination or expiration of this agreement?\",\n  \"document_id\": \"{{document_id}}\"\n}"
            },
            "url": { "raw": "{{base_url}}/query/ask", "host": ["{{base_url}}"], "path": ["query", "ask"] }
          }
        },
        {
          "name": "[Contract QA] Effective Date & Duration",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "console.log('[QA effective_date]', pm.response.json().answer.substring(0, 200));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"What is the effective date and duration of this contract? When does it expire?\",\n  \"document_id\": \"{{document_id}}\"\n}"
            },
            "url": { "raw": "{{base_url}}/query/ask", "host": ["{{base_url}}"], "path": ["query", "ask"] }
          }
        },
        {
          "name": "[Definition] Entity Alias Resolution",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "console.log('[Definition alias]', pm.response.json().answer.substring(0, 200));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"List all defined terms and their definitions in this contract. Who is referred to as 'Buyer', 'Seller', 'Service Provider', or similar aliases?\",\n  \"document_id\": \"{{document_id}}\"\n}"
            },
            "url": { "raw": "{{base_url}}/query/ask", "host": ["{{base_url}}"], "path": ["query", "ask"] }
          }
        }
      ]
    },
    {
      "name": "6 — Complex Document Deep Dive",
      "description": "Advanced queries against the complex IT Outsourcing and Procurement Framework documents — testing multi-section reasoning, cross-reference resolution, and inference chains.",
      "item": [
        {
          "name": "[Complex DOCX] SLA Penalties",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "console.log('[Complex] SLA:', pm.response.json().answer.substring(0, 300));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"What are the SLA targets and what penalties apply if they are not met?\",\n  \"document_id\": \"{{complex_docx_id}}\"\n}"
            },
            "url": { "raw": "{{base_url}}/query/ask", "host": ["{{base_url}}"], "path": ["query", "ask"] }
          }
        },
        {
          "name": "[Complex DOCX] Data Protection Obligations",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"What data protection and GDPR obligations does the service provider have? What happens in case of a data breach?\",\n  \"document_id\": \"{{complex_docx_id}}\"\n}"
            },
            "url": { "raw": "{{base_url}}/query/ask", "host": ["{{base_url}}"], "path": ["query", "ask"] }
          }
        },
        {
          "name": "[Complex DOCX] Price Escalation",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"What is the price escalation mechanism? What is the maximum annual increase allowed?\",\n  \"document_id\": \"{{complex_docx_id}}\"\n}"
            },
            "url": { "raw": "{{base_url}}/query/ask", "host": ["{{base_url}}"], "path": ["query", "ask"] }
          }
        },
        {
          "name": "[Complex DOCX] TrustGraph",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));",
                  "pm.test('Rich graph for complex doc', () => {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.nodes.length).to.be.above(100);",
                  "  pm.expect(body.edges.length).to.be.above(100);",
                  "  console.log('Complex DOCX graph:', body.nodes.length, 'nodes,', body.edges.length, 'edges');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": { "raw": "{{base_url}}/contracts/{{complex_docx_id}}/graph", "host": ["{{base_url}}"], "path": ["contracts", "{{complex_docx_id}}", "graph"] }
          }
        },
        {
          "name": "[Complex PDF] Volume Discounts",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"What are the volume discount tiers and percentages?\",\n  \"document_id\": \"{{complex_pdf_id}}\"\n}"
            },
            "url": { "raw": "{{base_url}}/query/ask", "host": ["{{base_url}}"], "path": ["query", "ask"] }
          }
        },
        {
          "name": "[Complex PDF] Liquidated Damages",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', () => pm.response.to.have.status(200));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"What are the liquidated damages provisions? What triggers them and what are the amounts?\",\n  \"document_id\": \"{{complex_pdf_id}}\"\n}"
            },
            "url": { "raw": "{{base_url}}/query/ask", "host": ["{{base_url}}"], "path": ["query", "ask"] }
          }
        }
      ]
    }
  ]
}
